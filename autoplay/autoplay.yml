---
env:
  pypirc_path: $HOME/.pypirc
shells:
  bash:
  - bash -eux
  docker:
  - docker run
      --rm
      -it
      alpine:lastest

---
name: twine
env:
  pypirc: |
    [pypi]
    username=${pypi_user-}
    password=${pypi_pass-}
setup:
- test -f $pypirc_path || echo $pypirc > $pypirc_path
script:
- for i in $(find . -name '*.po'); do msgfmt $i -o ${i/.po/.mo}; done
- python3 setup.py explain
- rm -rf dist
- python3 setup.py sdist
- twine upload dist/*

---
name: install
script:
- '[ ! -f requirements.txt ] || pip install -r requirements.txt'
- pip install -e .
